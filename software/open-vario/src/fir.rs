pub struct FIR<const N: usize> {
    coeffs: [f32; N],
    values: [f32; N],
    last_index: usize,
}

impl<const N: usize> FIR<N> {
    pub fn feed(&mut self, value: f32) {
        self.values[self.last_index] = value;
        self.last_index = (self.last_index + 1) % N;
    }
    pub fn output(&self) -> f32 {
        let mut output: f32 = 0.;
        for i in 0..N {
            let shifted_index = (self.last_index + i) % N;
            output += self.coeffs[i] * self.values[shifted_index]
        }
        output
    }
}

pub const FIR93: FIR<93> = FIR {
    coeffs: [
        0.000000000000000000,
        0.000000000000000000,
        0.000007188274115481,
        0.000026999392415735,
        0.000049699512645601,
        0.000049863203532925,
        0.000000000000000000,
        -0.000106466630123868,
        -0.000235784361628246,
        -0.000313423411736154,
        -0.000251660491775780,
        0.000000000000000000,
        0.000403178328101412,
        0.000808959582588773,
        0.000992137799152341,
        0.000744815418518378,
        -0.000000000000000001,
        -0.001072273934694242,
        -0.002059763470923100,
        -0.002430325033226228,
        -0.001762349297820786,
        0.000000000000000002,
        0.002390452110110751,
        0.004475318846985163,
        0.005158538261110197,
        0.003662355995274633,
        -0.000000000000000003,
        -0.004791312805438043,
        -0.008836419633830974,
        -0.010054535287361244,
        -0.007062019894287973,
        0.000000000000000005,
        0.009108666787451508,
        0.016750199379556279,
        0.019068143596055322,
        0.013452460567012516,
        -0.000000000000000006,
        -0.017780693242571512,
        -0.033453572438736034,
        -0.039359812124647071,
        -0.029101364265679112,
        0.000000000000000007,
        0.045364163923913244,
        0.099190334251021056,
        0.150217079433425715,
        0.186747434189619838,
        0.200007574943747768,
        0.186747434189619838,
        0.150217079433425743,
        0.099190334251021070,
        0.045364163923913244,
        0.000000000000000007,
        -0.029101364265679108,
        -0.039359812124647078,
        -0.033453572438736048,
        -0.017780693242571508,
        -0.000000000000000006,
        0.013452460567012516,
        0.019068143596055322,
        0.016750199379556286,
        0.009108666787451508,
        0.000000000000000005,
        -0.007062019894287979,
        -0.010054535287361239,
        -0.008836419633830977,
        -0.004791312805438043,
        -0.000000000000000003,
        0.003662355995274636,
        0.005158538261110193,
        0.004475318846985165,
        0.002390452110110752,
        0.000000000000000002,
        -0.001762349297820787,
        -0.002430325033226230,
        -0.002059763470923101,
        -0.001072273934694242,
        -0.000000000000000001,
        0.000744815418518378,
        0.000992137799152341,
        0.000808959582588773,
        0.000403178328101412,
        0.000000000000000000,
        -0.000251660491775781,
        -0.000313423411736154,
        -0.000235784361628246,
        -0.000106466630123867,
        0.000000000000000000,
        0.000049863203532925,
        0.000049699512645602,
        0.000026999392415735,
        0.000007188274115481,
        0.000000000000000000,
        0.000000000000000000,
    ],
    values: [0.; 93],
    last_index: 0,
};
pub const FIR59: FIR<59> = FIR {
    coeffs: [
        0.000000000000000000,
        -0.000011466433343440,
        -0.000048159680438716,
        -0.000070951498745996,
        0.000000000000000000,
        0.000226394896924650,
        0.000570593070542985,
        0.000843882357908127,
        0.000742644459879189,
        -0.000000000000000001,
        -0.001387330856962112,
        -0.002974017320060805,
        -0.003876072294410999,
        -0.003078546062261788,
        0.000000000000000002,
        0.004911281747189231,
        0.009897689392343489,
        0.012239432700612913,
        0.009302643950572093,
        -0.000000000000000005,
        -0.013947257358995015,
        -0.027649479941983943,
        -0.034045985830080304,
        -0.026173578588735643,
        0.000000000000000007,
        0.043288592274982135,
        0.096612134128292462,
        0.148460098539443669,
        0.186178664190551207,
        0.199977588313552862,
        0.186178664190551235,
        0.148460098539443669,
        0.096612134128292462,
        0.043288592274982128,
        0.000000000000000007,
        -0.026173578588735653,
        -0.034045985830080325,
        -0.027649479941983936,
        -0.013947257358995019,
        -0.000000000000000005,
        0.009302643950572094,
        0.012239432700612920,
        0.009897689392343489,
        0.004911281747189235,
        0.000000000000000002,
        -0.003078546062261790,
        -0.003876072294411004,
        -0.002974017320060808,
        -0.001387330856962112,
        -0.000000000000000001,
        0.000742644459879189,
        0.000843882357908127,
        0.000570593070542984,
        0.000226394896924650,
        0.000000000000000000,
        -0.000070951498745996,
        -0.000048159680438716,
        -0.000011466433343440,
        0.000000000000000000,
    ],
    values: [0.; 59],
    last_index: 0,
};

pub const FIR231: FIR<231> = FIR {
    coeffs: [
        0.000000000000000000,
        -0.000000069058970381,
        -0.000000094957348549,
        0.000000215851251588,
        0.000001139381462608,
        0.000002875309715418,
        0.000005493387875168,
        0.000008892168171557,
        0.000012776305459782,
        0.000016657215408619,
        0.000019879805536861,
        0.000021675501032863,
        0.000021239046339051,
        0.000017823799918882,
        0.000010847698681218,
        0.000000000000000000,
        -0.000014662452189849,
        -0.000032641146340608,
        -0.000052955123697172,
        -0.000074142907770427,
        -0.000094313746921970,
        -0.000111250995019159,
        -0.000122565919304153,
        -0.000125895243718051,
        -0.000119130698907818,
        -0.000100664199133876,
        -0.000069628464656553,
        -0.000026110402760304,
        0.000028686259362038,
        0.000092351440578863,
        0.000161271335123290,
        0.000230736865761235,
        0.000295164298133882,
        0.000348425500947504,
        0.000384275525228429,
        0.000396855129215511,
        0.000381236425982906,
        0.000333971860753401,
        0.000253601096080818,
        0.000141067861245485,
        0.000000000000000000,
        -0.000163188822194428,
        -0.000339407964709042,
        -0.000517228289703360,
        -0.000683453043014513,
        -0.000823905408205361,
        -0.000924397573458821,
        -0.000971827273545551,
        -0.000955331043499976,
        -0.000867410442447655,
        -0.000704939736100250,
        -0.000469962157737107,
        -0.000170187700932761,
        0.000180881262235820,
        0.000564249660715276,
        0.000956180867065051,
        0.001329393595041550,
        0.001654664045627443,
        0.001902757484473645,
        0.002046580295152364,
        0.002063415354122300,
        0.001937082957987910,
        0.001659858802393269,
        0.001233981415017568,
        0.000672594999834759,
        -0.000000000000000001,
        -0.000748877980550904,
        -0.001529841727705575,
        -0.002291583247960522,
        -0.002978576657272004,
        -0.003534567938629677,
        -0.003906470867690256,
        -0.004048431763093789,
        -0.003925792050059266,
        -0.003518660406045995,
        -0.002824808025724492,
        -0.001861622654166444,
        -0.000666899481482653,
        0.000701691698231953,
        0.002168546400046590,
        0.003643466802699710,
        0.005026303595180948,
        0.006212701847697263,
        0.007100665279854704,
        0.007597577024021429,
        0.007627257622053889,
        0.007136607632857736,
        0.006101376596833006,
        0.004530624245738588,
        0.002469493892959190,
        -0.000000000000000003,
        -0.002760361887121026,
        -0.005662249996071637,
        -0.008530287262081000,
        -0.011170840781674327,
        -0.013381429297662039,
        -0.014961300049879788,
        -0.015722621154566976,
        -0.015501670579378216,
        -0.014169373136472594,
        -0.011640545986526231,
        -0.007881261796741168,
        -0.002913825259515351,
        0.003181021007559842,
        0.010264897550534837,
        0.018145666006435371,
        0.026584278097587340,
        0.035304315828408026,
        0.044003781226364683,
        0.052368554689192118,
        0.060086833220004403,
        0.066863790702762549,
        0.072435676721770703,
        0.076582590423788233,
        0.079139230887027540,
        0.080003031903630145,
        0.079139230887027540,
        0.076582590423788233,
        0.072435676721770703,
        0.066863790702762549,
        0.060086833220004403,
        0.052368554689192139,
        0.044003781226364690,
        0.035304315828408026,
        0.026584278097587340,
        0.018145666006435371,
        0.010264897550534837,
        0.003181021007559842,
        -0.002913825259515351,
        -0.007881261796741168,
        -0.011640545986526233,
        -0.014169373136472594,
        -0.015501670579378221,
        -0.015722621154566976,
        -0.014961300049879790,
        -0.013381429297662039,
        -0.011170840781674326,
        -0.008530287262081000,
        -0.005662249996071637,
        -0.002760361887121026,
        -0.000000000000000003,
        0.002469493892959190,
        0.004530624245738588,
        0.006101376596833008,
        0.007136607632857736,
        0.007627257622053890,
        0.007597577024021431,
        0.007100665279854704,
        0.006212701847697265,
        0.005026303595180948,
        0.003643466802699710,
        0.002168546400046590,
        0.000701691698231953,
        -0.000666899481482653,
        -0.001861622654166444,
        -0.002824808025724494,
        -0.003518660406045997,
        -0.003925792050059268,
        -0.004048431763093792,
        -0.003906470867690258,
        -0.003534567938629678,
        -0.002978576657272005,
        -0.002291583247960522,
        -0.001529841727705575,
        -0.000748877980550905,
        -0.000000000000000001,
        0.000672594999834759,
        0.001233981415017568,
        0.001659858802393269,
        0.001937082957987911,
        0.002063415354122302,
        0.002046580295152365,
        0.001902757484473646,
        0.001654664045627443,
        0.001329393595041550,
        0.000956180867065053,
        0.000564249660715277,
        0.000180881262235820,
        -0.000170187700932761,
        -0.000469962157737107,
        -0.000704939736100251,
        -0.000867410442447656,
        -0.000955331043499977,
        -0.000971827273545552,
        -0.000924397573458822,
        -0.000823905408205361,
        -0.000683453043014515,
        -0.000517228289703360,
        -0.000339407964709042,
        -0.000163188822194428,
        0.000000000000000000,
        0.000141067861245486,
        0.000253601096080818,
        0.000333971860753401,
        0.000381236425982906,
        0.000396855129215511,
        0.000384275525228429,
        0.000348425500947506,
        0.000295164298133882,
        0.000230736865761235,
        0.000161271335123290,
        0.000092351440578863,
        0.000028686259362038,
        -0.000026110402760304,
        -0.000069628464656553,
        -0.000100664199133876,
        -0.000119130698907818,
        -0.000125895243718051,
        -0.000122565919304153,
        -0.000111250995019159,
        -0.000094313746921970,
        -0.000074142907770427,
        -0.000052955123697172,
        -0.000032641146340608,
        -0.000014662452189849,
        0.000000000000000000,
        0.000010847698681218,
        0.000017823799918882,
        0.000021239046339051,
        0.000021675501032863,
        0.000019879805536861,
        0.000016657215408619,
        0.000012776305459782,
        0.000008892168171557,
        0.000005493387875168,
        0.000002875309715418,
        0.000001139381462608,
        0.000000215851251588,
        -0.000000094957348549,
        -0.000000069058970381,
        0.000000000000000000,
    ],
    values: [0.; 231],
    last_index: 0,
};

pub const FIR155: FIR<155> = FIR {
    coeffs: [
        0.000000000000000000,
        -0.000000597102719628,
        -0.000002549387027135,
        -0.000005545603986033,
        -0.000008536611260828,
        -0.000009877497843416,
        -0.000007631529073672,
        0.000000000000000000,
        0.000014182979369038,
        0.000034970832669254,
        0.000060929853841174,
        0.000088957218319794,
        0.000114363701735018,
        0.000131264015470255,
        0.000133276942819704,
        0.000114488967544720,
        0.000070584484801517,
        0.000000000000000000,
        -0.000095073400506012,
        -0.000208028322187261,
        -0.000327696845442683,
        -0.000438859742129647,
        -0.000523476195252063,
        -0.000562609033212142,
        -0.000538914305983202,
        -0.000439456498693284,
        -0.000258517046649418,
        0.000000000000000001,
        0.000320980931987620,
        0.000677714630081224,
        0.001032990452008951,
        0.001341817624167925,
        0.001555706810331548,
        0.001628234064844576,
        0.001521387592541328,
        0.001212008440877179,
        0.000697507564670256,
        -0.000000000000000001,
        -0.000831939311233473,
        -0.001724517051091930,
        -0.002583297011213824,
        -0.003301079210870432,
        -0.003768636070390671,
        -0.003887439534743133,
        -0.003583142494048263,
        -0.002818308745171980,
        -0.001602764091251429,
        0.000000000000000002,
        0.001871684990190228,
        0.003844180034571161,
        0.005710970232346758,
        0.007244536846533613,
        0.008218598048793374,
        0.008433359521699841,
        0.007741399311582593,
        0.006071476183006250,
        0.003447483181707392,
        -0.000000000000000003,
        -0.004031570828695145,
        -0.008307501889012220,
        -0.012407095024365614,
        -0.015858012532109316,
        -0.018173611908006097,
        -0.018895341609551461,
        -0.017636523772978432,
        -0.014123448482479350,
        -0.008229694910801742,
        0.000000000000000004,
        0.010339205727081798,
        0.022384347403739655,
        0.035574736897804771,
        0.049227030251938142,
        0.062581651984438769,
        0.074857515672492561,
        0.085310480677864925,
        0.093290514995767140,
        0.098292540554935595,
        0.099996427950809763,
        0.098292540554935595,
        0.093290514995767140,
        0.085310480677864925,
        0.074857515672492575,
        0.062581651984438783,
        0.049227030251938142,
        0.035574736897804771,
        0.022384347403739655,
        0.010339205727081800,
        0.000000000000000004,
        -0.008229694910801744,
        -0.014123448482479355,
        -0.017636523772978436,
        -0.018895341609551461,
        -0.018173611908006104,
        -0.015858012532109316,
        -0.012407095024365614,
        -0.008307501889012218,
        -0.004031570828695145,
        -0.000000000000000003,
        0.003447483181707393,
        0.006071476183006251,
        0.007741399311582592,
        0.008433359521699841,
        0.008218598048793376,
        0.007244536846533613,
        0.005710970232346754,
        0.003844180034571161,
        0.001871684990190228,
        0.000000000000000002,
        -0.001602764091251430,
        -0.002818308745171983,
        -0.003583142494048265,
        -0.003887439534743132,
        -0.003768636070390671,
        -0.003301079210870436,
        -0.002583297011213824,
        -0.001724517051091929,
        -0.000831939311233473,
        -0.000000000000000001,
        0.000697507564670256,
        0.001212008440877180,
        0.001521387592541329,
        0.001628234064844577,
        0.001555706810331547,
        0.001341817624167926,
        0.001032990452008952,
        0.000677714630081225,
        0.000320980931987620,
        0.000000000000000001,
        -0.000258517046649418,
        -0.000439456498693285,
        -0.000538914305983203,
        -0.000562609033212142,
        -0.000523476195252063,
        -0.000438859742129647,
        -0.000327696845442683,
        -0.000208028322187261,
        -0.000095073400506012,
        0.000000000000000000,
        0.000070584484801517,
        0.000114488967544720,
        0.000133276942819705,
        0.000131264015470255,
        0.000114363701735018,
        0.000088957218319794,
        0.000060929853841174,
        0.000034970832669254,
        0.000014182979369038,
        0.000000000000000000,
        -0.000007631529073672,
        -0.000009877497843416,
        -0.000008536611260828,
        -0.000005545603986033,
        -0.000002549387027135,
        -0.000000597102719628,
        0.000000000000000000,
    ],
    values: [0.; 155],
    last_index: 0,
};

pub const MAVG: FIR<10> = FIR {
    coeffs: [0.1; 10],
    values: [0.; 10],
    last_index: 0,
};
